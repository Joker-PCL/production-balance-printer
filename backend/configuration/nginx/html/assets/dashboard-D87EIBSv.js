import{u as X,j as e,B as u,A as S,T as i,f as b,S as y,r as l,a as C,v as _,P as w,M as P,b as D,m as j,I as L,c as T,D as k,H as F}from"./index-D5Aj2ZG-.js";import{C as O}from"./config-global-DGEDRhMa.js";import{C as $,S as I}from"./Card-DWq2OP17.js";import{I as A,G as v}from"./flag-icon-BZA2QUkQ.js";import{A as B,a as z}from"./Autocomplete-DsD4Uumj.js";import{T as E}from"./TextField-iBoBQx9B.js";import{L as G}from"./loading_page-BW_yQFjS.js";import{D as M}from"./main-DsC71ZTs.js";function N({sx:r,post:t,...c}){const n=X(),s=a=>()=>{a.lot_number?n("/Details",{state:a}):I.fire({icon:"question",title:`เครื่อง ${a.machine}`,text:"ไม่พบข้อมูลการผลิต, ยังไม่มีข้อมูลการผลิตในวันนี้!",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"+ เพิ่มข้อมูล"}).then(f=>{f.isConfirmed&&n("/production/form")})},d=e.jsx(u,{component:"img",alt:t.machine,src:t.machine_img?t.machine_img:"./assets/images/machine/default.png",sx:{top:0,width:1,height:1,objectFit:"cover",position:"absolute"}}),x=e.jsx(S,{alt:t.machine,src:t.group_img?t.group_img:"./assets/images/machine/default.png",sx:{left:24,zIndex:9,bottom:-24,position:"absolute"}}),m=e.jsxs(e.Fragment,{children:[e.jsx(i,{variant:"body1",component:"div",sx:{color:"darkcyan"},children:`เลขที่ผลิต ${t.lot_number?t.lot_number:"XXXXXX"}`}),e.jsx(i,{variant:"body1",component:"div",sx:{color:"darkcyan"},children:`ชื่อยา ${t.product_name?t.product_name:"XXXXXX"}`}),e.jsx(i,{variant:"body2",component:"div",sx:{color:"grey"},children:`ขนาดการผลิต ${t.batch_size?t.batch_size.toLocaleString():"XXXXXX"}`}),e.jsxs(i,{variant:"body2",component:"div",sx:{mb:1,color:"grey"},children:[`เริ่มการผลิต ${t.start_product?b(t.start_product):"XXXXXX"}`,e.jsx("br",{}),`จบการผลิต ${t.finish_product?b(t.finish_product):"XXXXXX"}`]})]}),p=e.jsx(i,{variant:"body1",component:"div",onClick:s(t),sx:{color:"cornflowerblue",textDecoration:"underline",fontWeight:"500",cursor:"pointer"},children:t.machine}),g=e.jsx(i,{variant:"caption",component:"div",sx:{mb:1,color:"text.disabled"},children:t.last_connect?b(t.last_connect):"XXXXXX"}),o=e.jsx(u,{gap:1.5,display:"flex",flexWrap:"wrap",justifyContent:"flex-end",sx:{mt:3,color:"text.disabled"},children:[{number:t.gramCount,unit:"Gram",color:"primary.main",icon:"skill-icons:unity-light"},{number:t.pcsCount,unit:"Pcs",color:"secondary.main",icon:"material-symbols:scale"}].map((a,f)=>e.jsxs(u,{display:"flex",children:[e.jsx(i,{variant:"body1",sx:{mr:.5,color:a.color,fontWeight:"500"},alignItems:"center",children:a.unit}),e.jsx(i,{variant:"body1",sx:{fontWeight:"500"},children:a.number.toLocaleString()})]},f))}),h=e.jsx(y,{width:88,height:36,src:"/assets/icons/shape-avatar.svg",sx:{left:0,zIndex:9,bottom:-16,position:"absolute",color:"background.paper"}});return e.jsxs($,{sx:r,...c,children:[e.jsxs(u,{sx:a=>({position:"relative",pt:"calc(100% * 3 / 4)"}),children:[h,x,d]}),e.jsxs(u,{sx:a=>({p:a.spacing(6,3,3,3)}),children:[m,p,g,o]})]})}function W({options:r,sortBy:t,onSort:c,sx:n,...s}){var g;const[d,x]=l.useState(null),m=l.useCallback(o=>{x(o.currentTarget)},[]),p=l.useCallback(()=>{x(null)},[]);return e.jsxs(e.Fragment,{children:[e.jsx(C,{disableRipple:!0,color:"inherit",onClick:m,endIcon:e.jsx(A,{icon:d?"eva:chevron-up-fill":"eva:chevron-down-fill",sx:{ml:-.5}}),sx:{bgcolor:o=>_(o.vars.palette.grey["500Channel"],.08),...n},...s,children:(g=r.find(o=>o.value===t))==null?void 0:g.label}),e.jsx(w,{open:!!d,anchorEl:d,onClose:p,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(P,{disablePadding:!0,sx:{p:.5,gap:.5,width:160,display:"flex",flexDirection:"column",[`& .${j.root}`]:{px:1,gap:2,borderRadius:.75,[`&.${j.selected}`]:{bgcolor:"action.selected"}}},children:r.map(o=>e.jsx(D,{selected:o.value===t,onClick:()=>{c(o.value),p()},children:o.label},o.value))})})]})}function H({posts:r,onSearch:t,sx:c}){return e.jsx(B,{sx:{width:280},autoHighlight:!0,freeSolo:!0,onInputChange:t,popupIcon:null,slotProps:{paper:{sx:{width:320,[`& .${z.option}`]:{typography:"body2"},...c}}},options:r,getOptionLabel:n=>typeof n=="string"?n:n.machine,isOptionEqualToValue:(n,s)=>n.serial_number===s.serial_number,renderInput:n=>e.jsx(E,{...n,placeholder:"ค้นหาเครื่องจักร...",InputProps:{...n.InputProps,startAdornment:e.jsx(L,{position:"start",children:e.jsx(T,{children:e.jsx("path",{fill:"currentColor",d:"m20.71 19.29l-3.4-3.39A7.92 7.92 0 0 0 19 11a8 8 0 1 0-8 8a7.92 7.92 0 0 0 4.9-1.69l3.39 3.4a1 1 0 0 0 1.42 0a1 1 0 0 0 0-1.42M5 11a6 6 0 1 1 6 6a6 6 0 0 1-6-6"})})})}})})}function R({inputData:r,filterName:t}){return r=r.map((n,s)=>[n,s]).map(n=>n[0]),t&&(r=r.filter(n=>n.machine.toLowerCase().indexOf(t.toLowerCase())!==-1)),r}function q(){const r=X(),[t,c]=l.useState("latest"),[n,s]=l.useState(""),[d,x]=l.useState(!0),[m,p]=l.useState([]);l.useEffect(()=>{(async()=>{try{const a=await M();x(!1),p(a),console.log(a)}catch(a){a.status===401||a.status===403?r("/sign-in"):(I.fire({icon:"error",title:"เกิดข้อผิดพลาด...",text:"ไม่สามารถเชื่อมต่อกับฐานข้อมูลได้!",showConfirmButton:!1}),console.error("Error fetching data:",a))}})()},[r]);const g=R({inputData:m,filterName:n}),o=l.useCallback(h=>{c(h)},[]);return e.jsxs(e.Fragment,{children:[e.jsx(G,{isShowing:d}),e.jsxs(k,{children:[e.jsxs(u,{display:"flex",alignItems:"center",mb:5,children:[e.jsx(i,{variant:"h4",flexGrow:1,children:"Dashboard"}),e.jsx(C,{variant:"contained",color:"inherit",startIcon:e.jsx(y,{src:"/assets/icons/iconify/add.svg",width:"20px",height:"20px"}),children:"เพิ่มรายการเครื่องจักร"})]}),e.jsxs(u,{display:"flex",alignItems:"center",justifyContent:"space-between",sx:{mb:5},children:[e.jsx(H,{posts:m,onSearch:(h,a)=>{s(a)}}),e.jsx(W,{sortBy:t,onSort:o,options:[{value:"latest",label:"Latest"},{value:"popular",label:"Popular"},{value:"oldest",label:"Oldest"}]})]}),e.jsx(v,{container:!0,spacing:3,children:d?"":(n?g:m).map((h,a)=>e.jsx(v,{xs:12,sm:6,md:4,xl:3,children:e.jsx(N,{post:h})},h.serial_number))})]})]})}function te(){return e.jsxs(e.Fragment,{children:[e.jsx(F,{children:e.jsxs("title",{children:[" ",`Dashboard - ${O.appName}`]})}),e.jsx(q,{})]})}export{te as default};
