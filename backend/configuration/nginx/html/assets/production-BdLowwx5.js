import{j as o,B as E,T as W,g as B,h as $,r as a,s as D,N as ce,O as de,Q as k,_ as g,R as Z,i as A,o as pe,k as F,U as ue,l as P,n as I,V as xe,W as ge,u as ee,f as Y,w as O,S as R,a as te,P as he,M as fe,m as V,b as q,q as me,I as be,t as Ce,D as ve,x as je,H as ye}from"./index-CRELzJTI.js";import{C as De}from"./config-global-D85ZwODf.js";import{S as U,C as Pe}from"./Card-Ci9vwztD.js";import{T as L,a as h,R as G,b as we,c as Se,d as Te,e as ke,f as Re,g as We}from"./TableSortLabel-CE07kxBf.js";import{P as Me,O as Ne,b as Be}from"./main-zZCzAqhe.js";import{L as $e}from"./loading_page-CiyxAU-7.js";function Ae({searchQuery:e,...t}){return o.jsx(L,{...t,children:o.jsx(h,{align:"center",colSpan:7,children:o.jsxs(E,{sx:{py:15,textAlign:"center"},children:[o.jsx(W,{variant:"h6",sx:{mb:1},children:"Not found"}),o.jsxs(W,{variant:"body2",children:["No results found for  ",o.jsxs("strong",{children:['"',e,'"']}),".",o.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}function Fe(e){return $("MuiDialog",e)}const K=B("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),oe=a.createContext({}),Ie=["aria-describedby","aria-labelledby","BackdropComponent","BackdropProps","children","className","disableEscapeKeyDown","fullScreen","fullWidth","maxWidth","onBackdropClick","onClick","onClose","open","PaperComponent","PaperProps","scroll","TransitionComponent","transitionDuration","TransitionProps"],_e=D(ce,{name:"MuiDialog",slot:"Backdrop",overrides:(e,t)=>t.backdrop})({zIndex:-1}),Oe=e=>{const{classes:t,scroll:s,maxWidth:i,fullWidth:l,fullScreen:r}=e,n={root:["root"],container:["container",`scroll${k(s)}`],paper:["paper",`paperScroll${k(s)}`,`paperWidth${k(String(i))}`,l&&"paperFullWidth",r&&"paperFullScreen"]};return I(n,Fe,t)},Ue=D(de,{name:"MuiDialog",slot:"Root",overridesResolver:(e,t)=>t.root})({"@media print":{position:"absolute !important"}}),Ee=D("div",{name:"MuiDialog",slot:"Container",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.container,t[`scroll${k(s.scroll)}`]]}})(({ownerState:e})=>g({height:"100%","@media print":{height:"auto"},outline:0},e.scroll==="paper"&&{display:"flex",justifyContent:"center",alignItems:"center"},e.scroll==="body"&&{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}})),Le=D(Z,{name:"MuiDialog",slot:"Paper",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.paper,t[`scrollPaper${k(s.scroll)}`],t[`paperWidth${k(String(s.maxWidth))}`],s.fullWidth&&t.paperFullWidth,s.fullScreen&&t.paperFullScreen]}})(({theme:e,ownerState:t})=>g({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"}},t.scroll==="paper"&&{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"},t.scroll==="body"&&{display:"inline-block",verticalAlign:"middle",textAlign:"left"},!t.maxWidth&&{maxWidth:"calc(100% - 64px)"},t.maxWidth==="xs"&&{maxWidth:e.breakpoints.unit==="px"?Math.max(e.breakpoints.values.xs,444):`max(${e.breakpoints.values.xs}${e.breakpoints.unit}, 444px)`,[`&.${K.paperScrollBody}`]:{[e.breakpoints.down(Math.max(e.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}},t.maxWidth&&t.maxWidth!=="xs"&&{maxWidth:`${e.breakpoints.values[t.maxWidth]}${e.breakpoints.unit}`,[`&.${K.paperScrollBody}`]:{[e.breakpoints.down(e.breakpoints.values[t.maxWidth]+32*2)]:{maxWidth:"calc(100% - 64px)"}}},t.fullWidth&&{width:"calc(100% - 64px)"},t.fullScreen&&{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${K.paperScrollBody}`]:{margin:0,maxWidth:"100%"}})),ze=a.forwardRef(function(t,s){const i=A({props:t,name:"MuiDialog"}),l=pe(),r={enter:l.transitions.duration.enteringScreen,exit:l.transitions.duration.leavingScreen},{"aria-describedby":n,"aria-labelledby":c,BackdropComponent:d,BackdropProps:b,children:C,className:v,disableEscapeKeyDown:j=!1,fullScreen:p=!1,fullWidth:f=!1,maxWidth:w="sm",onBackdropClick:u,onClick:m,onClose:y,open:x,PaperComponent:M=Z,PaperProps:N={},scroll:S="paper",TransitionComponent:se=xe,transitionDuration:Q=r,TransitionProps:ne}=i,ie=F(i,Ie),_=g({},i,{disableEscapeKeyDown:j,fullScreen:p,fullWidth:f,maxWidth:w,scroll:S}),z=Oe(_),H=a.useRef(),ae=T=>{H.current=T.target===T.currentTarget},re=T=>{m&&m(T),H.current&&(H.current=null,u&&u(T),y&&y(T,"backdropClick"))},X=ue(c),le=a.useMemo(()=>({titleId:X}),[X]);return o.jsx(Ue,g({className:P(z.root,v),closeAfterTransition:!0,components:{Backdrop:_e},componentsProps:{backdrop:g({transitionDuration:Q,as:d},b)},disableEscapeKeyDown:j,onClose:y,open:x,ref:s,onClick:re,ownerState:_},ie,{children:o.jsx(se,g({appear:!0,in:x,timeout:Q,role:"presentation"},ne,{children:o.jsx(Ee,{className:P(z.container),onMouseDown:ae,ownerState:_,children:o.jsx(Le,g({as:M,elevation:24,role:"dialog","aria-describedby":n,"aria-labelledby":X},N,{className:P(z.paper,N.className),ownerState:_,children:o.jsx(oe.Provider,{value:le,children:C})}))})}))}))});function He(e){return $("MuiDialogActions",e)}B("MuiDialogActions",["root","spacing"]);const Xe=["className","disableSpacing"],Ye=e=>{const{classes:t,disableSpacing:s}=e;return I({root:["root",!s&&"spacing"]},He,t)},Ge=D("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,!s.disableSpacing&&t.spacing]}})(({ownerState:e})=>g({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},!e.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})),Ke=a.forwardRef(function(t,s){const i=A({props:t,name:"MuiDialogActions"}),{className:l,disableSpacing:r=!1}=i,n=F(i,Xe),c=g({},i,{disableSpacing:r}),d=Ye(c);return o.jsx(Ge,g({className:P(d.root,l),ownerState:c,ref:s},n))});function Qe(e){return $("MuiDialogContent",e)}B("MuiDialogContent",["root","dividers"]);function Ve(e){return $("MuiDialogTitle",e)}const qe=B("MuiDialogTitle",["root"]),Je=["className","dividers"],Ze=e=>{const{classes:t,dividers:s}=e;return I({root:["root",s&&"dividers"]},Qe,t)},et=D("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,s.dividers&&t.dividers]}})(({theme:e,ownerState:t})=>g({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px"},t.dividers?{padding:"16px 24px",borderTop:`1px solid ${(e.vars||e).palette.divider}`,borderBottom:`1px solid ${(e.vars||e).palette.divider}`}:{[`.${qe.root} + &`]:{paddingTop:0}})),tt=a.forwardRef(function(t,s){const i=A({props:t,name:"MuiDialogContent"}),{className:l,dividers:r=!1}=i,n=F(i,Je),c=g({},i,{dividers:r}),d=Ze(c);return o.jsx(et,g({className:P(d.root,l),ownerState:c,ref:s},n))});function ot(e){return $("MuiDialogContentText",e)}B("MuiDialogContentText",["root"]);const st=["children","className"],nt=e=>{const{classes:t}=e,i=I({root:["root"]},ot,t);return g({},t,i)},it=D(W,{shouldForwardProp:e=>ge(e)||e==="classes",name:"MuiDialogContentText",slot:"Root",overridesResolver:(e,t)=>t.root})({}),at=a.forwardRef(function(t,s){const i=A({props:t,name:"MuiDialogContentText"}),{className:l}=i,r=F(i,st),n=nt(r);return o.jsx(it,g({component:"p",variant:"body1",color:"text.secondary",ref:s,ownerState:r,className:P(n.root,l)},i,{classes:n}))}),rt=["className","id"],lt=e=>{const{classes:t}=e;return I({root:["root"]},Ve,t)},ct=D(W,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:"16px 24px",flex:"0 0 auto"}),dt=a.forwardRef(function(t,s){const i=A({props:t,name:"MuiDialogTitle"}),{className:l,id:r}=i,n=F(i,rt),c=i,d=lt(c),{titleId:b=r}=a.useContext(oe);return o.jsx(ct,g({component:"h2",className:P(d.root,l),ownerState:c,ref:s,variant:"h6",id:r??b},n))});function pt({row:e,selected:t,eventsRows:s,onEventsRows:i,onSelectRow:l}){const r=ee(),[n,c]=a.useState(null),[d,b]=a.useState("paper"),[C,v]=a.useState(!1),j=a.useCallback(x=>{c(x.currentTarget)},[]),p=a.useCallback(()=>{c(null)},[]),f=x=>()=>{v(!0),b(x)},w=()=>{v(!1)},u=x=>()=>{const{machine:M,start_product:N,finish_product:S}=x;M&&N&&S&&r("/Details",{state:x})},m=x=>{U.fire({title:"ยืนยันการลบรายการ",text:`ชื่อยา: ${x.product} เลขที่ผลิต: ${x.lot_number}`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"ยืนยันการลบ !",cancelButtonText:"ยกเลิก"}).then(M=>{M.isConfirmed&&(async()=>{try{const S=await Me(x);i(!s),U.fire({icon:"success",title:"ดำเนินการเรียบร้อยแล้ว",text:"บันทึกรายการผลิตเรียบร้อยแล้ว",showConfirmButton:!1,timer:2e3})}catch(S){console.error("Error fetching data:",S),U.fire({icon:"error",title:"เกิดข้อผิดพลาด...",text:"ไม่สามารถเชื่อมต่อกับฐานข้อมูลได้!, ลองไหม่อีกครั้ง",showCancelButton:!0,cancelButtonText:"ปิด"})}})()})},y=a.useRef(null);return a.useEffect(()=>{if(C){const{current:x}=y;x!==null&&x.focus()}},[C]),o.jsxs(o.Fragment,{children:[o.jsxs(L,{hover:!0,selected:t,style:{verticalAlign:"middle"},children:[o.jsx(h,{component:"th",scope:"row",children:o.jsxs(E,{gap:1,display:"flex",alignItems:"center",children:[o.jsx(G,{src:"/assets/icons/iconify/overtime.svg",style:{width:"40px",height:"40px"}}),Y(e.timestamp)]})}),o.jsx(h,{children:e.lot_number}),o.jsx(h,{children:e.product}),o.jsx(h,{children:e.batch_size?e.batch_size.toLocaleString():"X,XXX"}),o.jsx(h,{children:e.machine}),o.jsx(h,{children:Y(e.start_product)}),o.jsx(h,{children:Y(e.finish_product)}),o.jsx(h,{align:"center",children:o.jsx(O,{onClick:f("paper"),children:o.jsx(G,{src:"/assets/icons/iconify/note.svg",style:{width:"30px",height:"30px"}})})}),o.jsx(h,{align:"center",children:o.jsx(O,{onClick:u(e),children:o.jsx(G,{src:"/assets/icons/iconify/info.svg",style:{width:"30px",height:"30px"}})})}),o.jsx(h,{align:"center",children:o.jsx(O,{onClick:j,children:o.jsx(R,{src:"/assets/icons/iconify/menu.svg",width:"25px",height:"25px"})})})]}),o.jsxs(ze,{fullWidth:!0,maxWidth:"sm",open:C,onClose:w,"aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description",children:[o.jsx(dt,{id:"scroll-dialog-title",children:"รายละเอียดเพิ่มเติม"}),o.jsx(tt,{dividers:d==="paper",children:o.jsx(at,{id:"scroll-dialog-description",ref:y,tabIndex:-1,children:e.notes})}),o.jsx(Ke,{children:o.jsx(te,{onClick:w,variant:"contained",color:"error",children:"ปิด"})})]}),o.jsx(he,{open:!!n,anchorEl:n,onClose:p,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},children:o.jsxs(fe,{disablePadding:!0,sx:{p:.5,gap:.5,width:140,display:"flex",flexDirection:"column",[`& .${V.root}`]:{px:1,gap:2,borderRadius:.75,[`&.${V.selected}`]:{bgcolor:"action.selected"}}},children:[o.jsxs(q,{onClick:()=>{p(),e&&r("/production/form",{state:{row:e}})},children:[o.jsx(R,{src:"/assets/icons/iconify/edit.svg",width:"20px",height:"20px"}),"แก้ไข"]}),o.jsxs(q,{onClick:()=>{p(),m(e)},sx:{color:"error.main"},children:[o.jsx(R,{src:"/assets/icons/iconify/delete.svg",width:"20px",height:"20px"}),"ลบ"]})]})})]})}const ut={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function xt(e,t,s){return e?Math.max(0,(1+e)*t-s):0}function J(e,t,s){return t[s]<e[s]?-1:t[s]>e[s]?1:0}function gt(e,t){return e==="desc"?(s,i)=>-J(s,i,t):(s,i)=>J(s,i,t)}function ht({inputData:e,comparator:t,filterName:s,order:i}){const l=e.map((r,n)=>[r,n]);return l.sort((r,n)=>{const c=t(r[0],n[0]);return c!==0?c:i==="asc"?r[1]-n[1]:n[1]-r[1]}),e=l.map(r=>r[0]),s&&(e=e.filter(r=>Object.values(r).some(n=>String(n).toLowerCase().includes(s.toLowerCase())))),e}function ft({order:e,onSort:t,orderBy:s,rowCount:i,headLabel:l,numSelected:r}){return o.jsx(we,{children:o.jsx(L,{style:{verticalAlign:"top"},children:l.map(n=>o.jsx(h,{align:n.align||"left",sortDirection:s===n.id?e:!1,sx:{width:n.width,minWidth:n.minWidth},children:o.jsxs(Se,{hideSortIcon:!0,active:s===n.id,direction:s===n.id?e:"asc",onClick:()=>t(n.id),children:[n.label,s===n.id?o.jsx(E,{sx:{...ut},children:e==="desc"?"sorted descending":"sorted ascending"}):null]})},n.id))})})}function mt({emptyRows:e,height:t,sx:s,...i}){return e?o.jsx(L,{sx:{...t&&{height:t*e},...s},...i,children:o.jsx(h,{colSpan:9})}):null}function bt({numSelected:e,filterName:t,onFilterName:s}){return o.jsxs(me,{sx:{height:96,display:"flex",justifyContent:"space-between",p:i=>i.spacing(0,1,0,3),...e>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[e>0?o.jsxs(W,{component:"div",variant:"subtitle1",children:[e," selected"]}):o.jsx(Ne,{fullWidth:!0,value:t,onChange:s,placeholder:"ค้นหาข้อมูลในตาราง...",startAdornment:o.jsx(be,{position:"start",children:o.jsx(R,{src:"/assets/icons/iconify/filter.svg",width:"20px",height:"20px",sx:{color:"text.disabled"}})}),sx:{maxWidth:320}}),o.jsx(Ce,{title:"Filter list",children:o.jsx(O,{children:o.jsx(R,{src:"/assets/icons/iconify/filter.svg",width:"20px",height:"20px",sx:{color:"text.disabled"}})})})]})}function Ct(){const e=ee(),t=vt(),[s,i]=a.useState(!0),[l,r]=a.useState(!1),[n,c]=a.useState([]),[d,b]=a.useState("");a.useState(""),a.useEffect(()=>{(async()=>{try{const f=await Be();i(!1),c(f),console.log(f)}catch(f){f.status===401||f.status===403?e("/sign-in"):(U.fire({icon:"error",title:"เกิดข้อผิดพลาด...",text:"ไม่สามารถเชื่อมต่อกับฐานข้อมูลได้!",showConfirmButton:!1}),console.error("Error fetching data:",f))}})()},[l,e]);const C=()=>()=>{e("/production/form")},v=ht({inputData:n,comparator:gt(t.order,t.orderBy),filterName:d,order:"asc"}),j=!v.length&&!!d;return o.jsxs(o.Fragment,{children:[o.jsx($e,{isShowing:s}),o.jsxs(ve,{children:[o.jsxs(E,{display:"flex",alignItems:"center",mb:5,children:[o.jsx(W,{variant:"h4",flexGrow:1,children:"รายการผลิต"}),o.jsx(te,{variant:"contained",color:"inherit",onClick:C(),startIcon:o.jsx(R,{src:"/assets/icons/iconify/add.svg",width:"20px",height:"20px"}),children:"เพิ่มรายการ"})]}),o.jsxs(Pe,{children:[o.jsx(bt,{numSelected:t.selected.length,filterName:d,onFilterName:p=>{b(p.target.value),t.onResetPage()}}),o.jsx(je,{children:o.jsx(Te,{sx:{overflow:"unset"},children:o.jsxs(ke,{sx:{minWidth:1100},children:[o.jsx(ft,{order:t.order,orderBy:t.orderBy,rowCount:n.length,numSelected:t.selected.length,onSort:t.onSort,headLabel:[{id:"timestamp",label:"Timestamp"},{id:"lot_number",label:"เลขที่ผลิต"},{id:"product_names",label:"รายการผลิต"},{id:"batch_size",label:"ขนาดผลิต"},{id:"machine",label:"เครื่องจักร"},{id:"start_product",label:"วันที่เริ่มการผลิต"},{id:"finish_product",label:"วันที่จบการผลิต"},{id:"note",label:"Note",align:"center"},{id:"info",label:"ข้อมูล",align:"center"},{id:"edit",label:"แก้ไข",align:"center"}]}),o.jsxs(Re,{children:[v.slice(t.page*t.rowsPerPage,t.page*t.rowsPerPage+t.rowsPerPage).map(p=>o.jsx(pt,{row:p,eventsRows:l,onEventsRows:r,selected:t.selected.includes(p.id),onSelectRow:()=>t.onSelectRow(p.id)},p.id)),o.jsx(mt,{height:68,emptyRows:xt(t.page,t.rowsPerPage,n.length)}),j&&o.jsx(Ae,{searchQuery:d})]})]})})}),o.jsx(We,{component:"div",page:t.page,count:n.length,rowsPerPage:t.rowsPerPage,onPageChange:t.onChangePage,rowsPerPageOptions:[5,10,25],onRowsPerPageChange:t.onChangeRowsPerPage})]})]})]})}function vt(){const[e,t]=a.useState(0),[s,i]=a.useState("name"),[l,r]=a.useState(5),[n,c]=a.useState([]),[d,b]=a.useState("asc"),C=a.useCallback(u=>{b(s===u&&d==="asc"?"desc":"asc"),i(u)},[d,s]),v=a.useCallback((u,m)=>{if(u){c(m);return}c([])},[]),j=a.useCallback(u=>{const m=n.includes(u)?n.filter(y=>y!==u):[...n,u];c(m)},[n]),p=a.useCallback(()=>{t(0)},[]),f=a.useCallback((u,m)=>{t(m)},[]),w=a.useCallback(u=>{r(parseInt(u.target.value,10)),p()},[p]);return{page:e,order:d,onSort:C,orderBy:s,selected:n,rowsPerPage:l,onSelectRow:j,onResetPage:p,onChangePage:f,onSelectAllRows:v,onChangeRowsPerPage:w}}function Tt(){return o.jsxs(o.Fragment,{children:[o.jsx(ye,{children:o.jsxs("title",{children:[" ",`Production - ${De.appName}`]})}),o.jsx(Ct,{})]})}export{Tt as default};
